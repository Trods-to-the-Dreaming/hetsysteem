{{#block "title"}}Beurt{{/block}}

<script>
	const isCharacterCustomized = {{isCharacterCustomized}};
	const characterState = {{{json characterState}}};
	
	localStorage.setItem('isCharacterCustomized', JSON.stringify(isCharacterCustomized));
	localStorage.setItem('characterState', JSON.stringify(characterState));
	
	const allProducts = {{{json allProducts}}};
	const allRecreations = {{{json allRecreations}}};
	const allBuildings = {{{json allBuildings}}};
	
	localStorage.setItem('allProducts', JSON.stringify(allProducts));
	localStorage.setItem('allRecreations', JSON.stringify(allRecreations));
	localStorage.setItem('allBuildings', JSON.stringify(allBuildings));
	
	const stepsData = {{{json stepsData}}};
	
	stepsData.forEach((stepData, index) => {
		localStorage.setItem(`turn.step.${index}`, JSON.stringify(stepData));
	});
	
	const steps = {{{json steps}}};
	const firstStepIndex = {{firstStepIndex}};
	const lastStepIndex = {{lastStepIndex}};
	const activeStepIndex = {{activeStepIndex}};

	localStorage.setItem('turn.steps', JSON.stringify(steps));
	localStorage.setItem('turn.firstStepIndex', firstStepIndex);
	localStorage.setItem('turn.lastStepIndex', lastStepIndex);
	localStorage.setItem('turn.activeStepIndex', activeStepIndex);
	
	localStorage.setItem('turn.begin', true);
	
	window.location.replace(steps[activeStepIndex].url);
</script>